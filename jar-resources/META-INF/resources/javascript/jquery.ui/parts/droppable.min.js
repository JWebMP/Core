
/*!
 * jQuery UI Droppable @VERSION
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","./core","./widget","./mouse","./draggable"],a)}else{a(jQuery)}}(function(b){b.widget("ui.droppable",{version:"@VERSION",widgetEventPrefix:"drop",options:{accept:"*",addClasses:true,greedy:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var d,e=this.options,c=e.accept;this.isover=false;this.isout=true;this.accept=b.isFunction(c)?c:function(f){return f.is(c)};this.proportions=function(){if(arguments.length){d=arguments[0]}else{return d?d:d={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(e.scope);e.addClasses&&this._addClass("ui-droppable")},_addToManager:function(c){b.ui.ddmanager.droppables[c]=b.ui.ddmanager.droppables[c]||[];b.ui.ddmanager.droppables[c].push(this)},_splice:function(c){var d=0;for(;d<c.length;d++){if(c[d]===this){c.splice(d,1)}}},_destroy:function(){var c=b.ui.ddmanager.droppables[this.options.scope];this._splice(c)},_setOption:function(d,e){if(d==="accept"){this.accept=b.isFunction(e)?e:function(f){return f.is(e)}}else{if(d==="scope"){var c=b.ui.ddmanager.droppables[this.options.scope];this._splice(c);this._addToManager(e)}}this._super(d,e)},_activate:function(d){var c=b.ui.ddmanager.current;this._addActiveClass();if(c){this._trigger("activate",d,this.ui(c))}},_deactivate:function(d){var c=b.ui.ddmanager.current;this._removeActiveClass();if(c){this._trigger("deactivate",d,this.ui(c))}},_over:function(d){var c=b.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(c.currentItem||c.element))){this._addHoverClass();this._trigger("over",d,this.ui(c))}},_out:function(d){var c=b.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(c.currentItem||c.element))){this._removeHoverClass();this._trigger("out",d,this.ui(c))}},_drop:function(d,e){var c=e||b.ui.ddmanager.current,f=false;if(!c||(c.currentItem||c.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var g=b(this).droppable("instance");if(g.options.greedy&&!g.options.disabled&&g.options.scope===c.options.scope&&g.accept.call(g.element[0],(c.currentItem||c.element))&&a(c,b.extend(g,{offset:g.element.offset()}),g.options.tolerance,d)){f=true;return false}});if(f){return false}if(this.accept.call(this.element[0],(c.currentItem||c.element))){this._removeActiveClass();this._removeHoverClass();this._trigger("drop",d,this.ui(c));return this.element}return false},ui:function(d){return{draggable:(d.currentItem||d.element),helper:d.helper,position:d.position,offset:d.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var a=(function(){function c(e,d,f){return(e>=d)&&(e<(d+f))}return function(p,i,n,e){if(!i.offset){return false}var g=(p.positionAbs||p.position.absolute).left+p.margins.left,m=(p.positionAbs||p.position.absolute).top+p.margins.top,f=g+p.helperProportions.width,k=m+p.helperProportions.height,h=i.offset.left,o=i.offset.top,d=h+i.proportions().width,j=o+i.proportions().height;switch(n){case"fit":return(h<=g&&f<=d&&o<=m&&k<=j);case"intersect":return(h<g+(p.helperProportions.width/2)&&f-(p.helperProportions.width/2)<d&&o<m+(p.helperProportions.height/2)&&k-(p.helperProportions.height/2)<j);case"pointer":return c(e.pageY,o,i.proportions().height)&&c(e.pageX,h,i.proportions().width);case"touch":return((m>=o&&m<=j)||(k>=o&&k<=j)||(m<o&&k>j))&&((g>=h&&g<=d)||(f>=h&&f<=d)||(g<h&&f>d));default:return false}}})();b.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(f,h){var e,d,c=b.ui.ddmanager.droppables[f.options.scope]||[],g=h?h.type:null,k=(f.currentItem||f.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(e=0;e<c.length;e++){if(c[e].options.disabled||(f&&!c[e].accept.call(c[e].element[0],(f.currentItem||f.element)))){continue}for(d=0;d<k.length;d++){if(k[d]===c[e].element[0]){c[e].proportions().height=0;continue droppablesLoop}}c[e].visible=c[e].element.css("display")!=="none";if(!c[e].visible){continue}if(g==="mousedown"){c[e]._activate.call(c[e],h)}c[e].offset=c[e].element.offset();c[e].proportions({width:c[e].element[0].offsetWidth,height:c[e].element[0].offsetHeight})}},drop:function(c,d){var e=false;b.each((b.ui.ddmanager.droppables[c.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&a(c,this,this.options.tolerance,d)){e=this._drop.call(this,d)||e}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(c.currentItem||c.element))){this.isout=true;this.isover=false;this._deactivate.call(this,d)}});return e},dragStart:function(c,d){c.element.parentsUntil("body").on("scroll.droppable",function(){if(!c.options.refreshPositions){b.ui.ddmanager.prepareOffsets(c,d)}})},drag:function(c,d){if(c.options.refreshPositions){b.ui.ddmanager.prepareOffsets(c,d)}b.each(b.ui.ddmanager.droppables[c.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var h,f,e,g=a(c,this,this.options.tolerance,d),i=!g&&this.isover?"isout":(g&&!this.isover?"isover":null);if(!i){return}if(this.options.greedy){f=this.options.scope;e=this.element.parents(":data(ui-droppable)").filter(function(){return b(this).droppable("instance").options.scope===f});if(e.length){h=b(e[0]).droppable("instance");h.greedyChild=(i==="isover")}}if(h&&i==="isover"){h.isover=false;h.isout=true;h._out.call(h,d)}this[i]=true;this[i==="isout"?"isover":"isout"]=false;this[i==="isover"?"_over":"_out"].call(this,d);if(h&&i==="isout"){h.isout=false;h.isover=true;h._over.call(h,d)}})},dragStop:function(c,d){c.element.parentsUntil("body").off("scroll.droppable");if(!c.options.refreshPositions){b.ui.ddmanager.prepareOffsets(c,d)}}};if(b.uiBackCompat!==false){b.widget("ui.droppable",b.ui.droppable,{options:{hoverClass:false,activeClass:false},_addActiveClass:function(){this._super();if(this.options.activeClass){this.element.addClass(this.options.activeClass)}},_removeActiveClass:function(){this._super();if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}},_addHoverClass:function(){this._super();if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}},_removeHoverClass:function(){this._super();if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}}})}return b.ui.droppable}));