
(function(a){a.fn.reingoldTree=function(b){b=a.extend({},a.fn.reingoldTree.defaults,b);var j=b.data;var f=b.diameter;var e="#"+a(this).prop("id");var h={top:b.marginTop,right:b.marginRight,bottom:b.marginBottom,left:b.marginLeft},c=960-h.right-h.left,p=800-h.top-h.bottom;var l=0,g=b.animationSpeed,n;var r=d3.layout.tree().size([p,c]);var d=d3.svg.diagonal().projection(function(i){return[i.y,i.x]});var m=d3.select(e).append("svg").attr("width",c+h.right+h.left).attr("height",p+h.top+h.bottom).append("g").attr("transform","translate("+h.left+","+h.top+")");n=j;n.x0=p/2;n.y0=0;function o(i){if(i.children){i._children=i.children;i._children.forEach(o);i.children=null}}n.children.forEach(o);k(n);d3.select(self.frameElement).style("height",f+"px");function k(E){var D=r.nodes(n).reverse(),i=r.links(D);D.forEach(function(J){J.y=J.depth*180});var B=b.nodeMarker;var y=b.nodeWithChildrenMarker;var H=b.nodeEnterMarker;var u=b.nodeExitMarker;var I=b.nodeText;var A=b.nodeEnterText;var C=b.nodeExitText;var w=b.nodeLink;var s=b.nodeEnterLink;var z=b.nodeEnterLink;var F=m.selectAll("g.node").data(D,function(J){return J.id||(J.id=++l)});var v=F.enter().append("g").attr("class","node").attr("transform",function(J){return"translate("+E.y0+","+E.x0+")"}).on("click",q);v.append(H.markerType).attr("r",H.markerSize).style({fill:H.fill,stroke:H.stroke,"stroke-width":H.strokeWidth,"fill-opacity":H.fillOpacity,"margin-left":H.marginLeft,"margin-right":H.marginRight,"margin-top":H.marginTop,"margin-bottom":H.marginBottom});v.append("text").attr("x",function(J){return J.children||J._children?-10:10}).attr("dy",".35em").attr("text-anchor",function(J){return J.children||J._children?"end":"start"}).text(function(J){return J.name}).style({"font-size":A.fontSize,"font-name":A.fontName,"font-weight":A.fontWeight,"font-color":A.fontColour,"fill-opacity":A.fillOpacity,"background-color":A.backgroundColour,"margin-left":H.marginLeft,"margin-right":H.marginRight,"margin-top":H.marginTop,"margin-bottom":H.marginBottom});var t=F.transition().duration(g).attr("transform",function(J){return"translate("+J.y+","+J.x+")"});t.select(B.markerType).attr("r",B.markerSize).style({fill:function(J){return J._children?y.fill:B.fill},stroke:B.stroke,"stroke-width":B.strokeWidth,"fill-opacity":B.fillOpacity,"margin-left":H.marginLeft,"margin-right":H.marginRight,"margin-top":H.marginTop,"margin-bottom":H.marginBottom});t.select("text").style({"font-size":I.fontSize,"font-name":I.fontName,"font-weight":I.fontWeight,color:I.fontColour,"fill-opacity":I.fillOpacity,"background-color":I.backgroundColour,"margin-left":H.marginLeft,"margin-right":H.marginRight,"margin-top":H.marginTop,"margin-bottom":H.marginBottom});var G=F.exit().transition().duration(g).attr("transform",function(J){return"translate("+E.y+","+E.x+")"}).remove();G.select(u.markerType).attr("r",u.markerSize).style({fill:u.fill,stroke:u.stroke,"stroke-width":u.strokeWidth,"fill-opacity":u.fillOpacity,"margin-left":H.marginLeft,"margin-right":H.marginRight,"margin-top":H.marginTop,"margin-bottom":H.marginBottom});G.select("text").style({"font-size":C.fontSize,"font-name":C.fontName,"font-weight":C.fontWeight,"font-color":C.fontColour,"fill-opacity":C.fillOpacity,"background-color":C.backgroundColour,"margin-left":H.marginLeft,"margin-right":H.marginRight,"margin-top":H.marginTop,"margin-bottom":H.marginBottom});var x=m.selectAll("path.link").data(i,function(J){return J.target.id}).style({fill:w.fill,"fill-opacity":w.fillOpacity,"stroke-opacity":w.strokeOpacity,stroke:w.stroke,"stroke-width":w.strokeWidth,"margin-left":w.marginLeft,"margin-right":w.marginRight,"margin-top":w.marginTop,"margin-bottom":w.marginBottom});x.enter().insert("path","g").attr("class","link").attr("d",function(K){var J={x:E.x0,y:E.y0};return d({source:J,target:J})}).style({fill:s.fill,"fill-opacity":s.fillOpacity,stroke:s.stroke,"stroke-width":s.strokeWidth,"margin-left":s.marginLeft,"margin-right":s.marginRight,"margin-top":s.marginTop,"margin-bottom":s.marginBottom,"stroke-opacity":s.strokeOpacity});x.transition().duration(g).attr("d",d);x.exit().transition().duration(g).attr("d",function(K){var J={x:E.x,y:E.y};return d({source:J,target:J})}).style({fill:z.fill,"fill-opacity":z.fillOpacity,"stroke-opacity":z.strokeOpacity,stroke:z.stroke,"stroke-width":z.strokeWidth,"margin-left":z.marginLeft,"margin-right":z.marginRight,"margin-top":z.marginTop,"margin-bottom":z.marginBottom}).remove();D.forEach(function(J){J.x0=J.x;J.y0=J.y})}function q(i){if(i.children){i._children=i.children;i.children=null}else{i.children=i._children;i._children=null}k(i)}};a.fn.reingoldTree.defaults={diameter:960,data:null,nodeDistance:100,marginLeft:120,marginRight:120,marginTop:20,marginBottom:20,animationSpeed:600,maximumDegrees:360,nodeMarker:{markerType:"circle",markerSize:4.5,fill:"white",stroke:"steelblue",strokeWidth:"1.5px",marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,fillOpacity:1},nodeWithChildrenMarker:{markerType:"circle",markerSize:4.5,fill:"steelblue",stroke:"steelblue",strokeWidth:"1.5px",marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,fillOpacity:1},nodeEnterMarker:{markerType:"circle",markerSize:18,fill:"purple",stroke:"steelblue",strokeWidth:"1.5px",marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,fillOpacity:1},nodeExitMarker:{markerType:"circle",markerSize:28,fill:"steelblue",stroke:"steelblue",strokeWidth:"1.5px",marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,fillOpacity:1},nodeText:{fontSize:"14px",fontName:"sans-serif",fontWeight:1,fontColour:"black",fillOpacity:1,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,backgroundColour:"white"},nodeEnterText:{fontSize:"14px",fontName:"sans-serif",fontWeight:1,fontColour:"black",fillOpacity:1,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,backgroundColour:"white"},nodeExitText:{fontSize:"14px",fontName:"sans-serif",fontWeight:1,fontColour:"black",fillOpacity:1,backgroundColour:"white"},nodeLink:{fill:"none",fillOpacity:0.6,stroke:"ccc",strokeWidth:"1.5px",strokeOpacity:1,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0},nodeEnterLink:{fill:"royalBlue",fillOpacity:0.6,stroke:"ccc",strokeWidth:"1.5px",marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,strokeOpacity:1},nodeExitLink:{fill:"royalBlue",fillOpacity:0.6,stroke:"ccc",strokeWidth:"1.5px",marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,strokeOpacity:1}}})(jQuery);